function zDg(a,b){return new To(function(c,d){iq(Vk(Wk(Uk(jq(Tk(a.C.Ue("/answers/tablemetadata"),"did",b),"POST"),2),function(e){var f=new Mk;f.Tg=!0;e=f.Tc(bM.Aa(),e.Ee());c(e)}),function(){var e=new bM;d(e)})).Se()})}function ADg(a,b,c){var d=new Mk;d.Tg=!0;var e=d.serialize(b);return new To(function(f,h){Fn(c,function(){fM(a,"/dbx/validateCalculatedColumn",[],e,function(k){k=d.Tc(ZL.Aa(),k.Ee());f(k)},function(){var k=new ZL,l=new zg;E(k,1,l);l.Ub(3);RDd(l);h(k)})})})}
function BDg(a,b,c){var d=new Mk;d.Tg=!0;var e=d.serialize(b);return new To(function(f,h){Fn(c,function(){fM(a,"/dbx/refreshObject",a.F?["esid",a.F]:[],e,function(k){d.Tg=!1;k=d.Tc(Lac.Aa(),k.Ee());f(k)},function(){var k=new Lac,l=new zg;l.Ub(3);RDd(l);var n=new UL;E(n,1,l);fg(k,2,n);h(k)})})})}function CDg(a,b){var c=new Set;b.forEach(function(d){a.O.add(d);c.add(d)});tdc(a,c,"dbobjectmodel-event-update")}function DDg(a){a.cd&&a.cd.$c(a.La(),a.L?5:1,new fm(0,a.L?50:0,12,a.L?0:50))}
function EDg(a,b,c,d,e,f,h,k){NN.call(this,a,b,c,d,e,k);this.F=new zxc(h,d.jc(),k);this.Ga(this.F,!0);this.H=f;this.C=null}u(EDg,NN);EDg.prototype.Ca=function(){var a=this.qa().Ca("DIV","waffle-dbsource-container");this.jb(a)};EDg.prototype.Ia=function(){NN.prototype.Ia.call(this);this.C=new tB(this.La(),this.qa());uB(this.C)};EDg.prototype.vd=function(){Hf(this.C);NN.prototype.vd.call(this)};
EDg.prototype.focus=function(){var a=this.F;a.C.isVisible()&&a.C.isEnabled()&&(a.C.La().focus(),a.C.vr(!0));this.H.Ub(2)};function FDg(a){return a.D?Object.values(a.D).find(function(b){if(!(b instanceof QP))return!1;b=b.getElement();return!!b&&!!b.querySelector(":hover")})||null:null}function GDg(a){a=FDg(a.J);if(!a)return null;a=a.Wd().getId();return ritz_api.BigSheetsApi.getExternalDataIdForObject(a)}
function HDg(a){var b=a.L.C.C;if(nH(b))return ritz_api.BigSheetsApi.getExternalDataIdForDatasourceSheet(b.ib());(b=GDg(a))||(b=(b=cLc(a))?dLc(a,b):null);if(b)return b;a:{b=a.J.C;for(var c=b.length-1;0<=c;c--){var d=WP(a.J,b[c]).Wd();if(d instanceof vN&&null!=d.D&&(d=d.getId(),d=ritz_api.BigSheetsApi.getExternalDataIdForObject(d))){b=d;break a}}b=null}if(b)return b;b=rK(a.Sa());return dLc(a,b)}
function IDg(a,b){[a.J,a.V].forEach(function(c){return c.setPosition(b)});a.C.some(function(c){c.C.setPosition(b)})}function JDg(){var a=new iC,b="Configure a project in the Google Cloud Platform console to continue. "+(a.qd("a",{"class":"goog-inline-block",href:"https://support.google.com/docs/answer/9077536",target:"_blank"})+("Learn more"+a.jd("a")));return a.format(b)}function KDg(a,b){return{title:a,body:b}}function LDg(a){return KDg("Query failed",a)}
function MDg(a,b){var c=b.getErrorCode();b=D(b,3);switch(c){case 20:return LDg(F7e(3,b));case 6:return a=(new uA("{objectType, select, chart {The data source took too long to return this chart. Please try again.} pivot_table {The data source took too long to return this pivot table. Please try again.} formula {The data source took too long to return this formula result. Please try again.} record {The data source took too long to return this extract. Please try again.} datasource_preview {The data source took too long to return this preview. Please try again.} other {The data source took too long to return data. Please try again.}}")).format({objectType:a?
O7e[a]||"other":"other"}),KDg("Timed out",G7e(a,b));case 8:c=P7e.format(Ic(z(),"febpr")?5E4:3E4);var d=P7e.format(Ic(z(),"femdrr")?5E4:1E4);c=(new uA("{objectType, select, chart {Results exceed {maxRows} rows. Update this chart and try again.}pivot_table {Update the number of rows and/or columns to a maximum of {dbPivotTableMaxRows} by using filtering, grouping, or customizing number of rows and/or columns. Then, try again.}formula {Results exceed {maxRows} rows. Update this function and try again.} record {Results exceed {dbRecordMaxRows} rows. Update this extract and try again.} datasource_preview {Results exceed {maxRows} rows. Update this connected sheet and try again.} other {Results exceed {maxRows} rows. Update this query and try again.}}")).format({objectType:a?
O7e[a]||"other":"other",maxRows:H7e,dbPivotTableMaxRows:c,dbRecordMaxRows:d});return KDg(1==a?"Rows and/or columns exceed limit":"Too many rows",G7e(c,b));case 18:return KDg("Unsupported type",HZ("The query returns an ARRAY or a STRUCT type, which is currently not supported."));case 19:return LDg(J7e());case 22:return LDg(K7e());case 26:return LDg(HZ("The column type of connected data is not compatible with the operation."));case 30:return LDg(HZ("Sorting by an array column is not supported for connected sheets and extracts."));
case 32:return KDg("Too many customized number of rows & columns",HZ("Your pivot table contains one or more array database columns. Only one can have customized number of rows or columns."));case 33:return LDg(HZ("Results exceed storage limit. Update query and run again."))}return LDg(L7e(b))}
function NDg(){var a='<div class="'+T("waffle-bigquerydbsourcesettingsdialog-project-section")+'"><h3 class="'+T("waffle-bigquerydbsourcesettingsdialog-project-header")+'">';a=a+'Choose a cloud project</h3><div class="'+(T("waffle-bigquerydbsourcesettingsdialog-project-menu-wrapper")+'"></div></div>');return S(a)}
function ODg(){var a='<div class="'+T("waffle-bigquerydbsourcesettingsdialog-footer-wrapper")+'"><p class="'+T("waffle-bigquerydbsourcesettingsdialog-footer-message")+'">';return S(a+'Your use of BigQuery is governed by the <a href="https://cloud.google.com/terms/" target="_blank">Google Cloud Platform Terms of Service</a>.</p></div>')};function PDg(a,b,c){NZ.call(this,"waffle-bigquerydbsourcesettingsdialog",c);this.setTitle(this.qa().Ca("SPAN",void 0,"Add data connection"));this.H=a;this.F=b;this.D=new H8e(void 0,this.qa());this.Ga(this.D)}u(PDg,NZ);PDg.prototype.Ca=function(){NZ.prototype.Ca.call(this);Qx(this.Hb(),NDg);GZ(this).appendChild(Sx(ODg));this.D.render(this.bb("waffle-bigquerydbsourcesettingsdialog-project-menu-wrapper"));qY(this.D).setAttribute("placeholder","Search projects");this.qa().ai(this.D.La(),!1)};
PDg.prototype.Ia=function(){var a=this;NZ.prototype.Ia.call(this);this.D.Rn(!0);u8e(this.H).then(function(b){a.Gb()&&(b&&0!=b.length||a.F.C(36566),QDg(a,b),a.D.Rn(!1))},function(){a.reject(!0)})};
function QDg(a,b){if(0==b.length){var c=a.qa(),d=Po(c,JDg());P(a.Fa("waffle-bigquerydbsourcesettingsdialog-project-menu-wrapper"),!1);c.appendChild(a.Fa("waffle-bigquerydbsourcesettingsdialog-project-section"),c.Ca("DIV","waffle-bigquerydbsourcesettingsdialog-error-caption",d))}else RDg(a,b),a.getHandler().listen(a.D,"action",function(e){return SDg(a,e,b)})}
function RDg(a,b){b=TDg(b);J8e(a.D,b);O8e(a.D);b=a.D;var c="We are only showing the top "+(pxc.format(1E4)+" projects. Use the search bar to find unlisted projects.");b.F.setVisible(!0);b.F.C.setContent(b.qa().Ca("DIV",void 0,b.qa().Ca("DIV",{id:"waffle-dataconnector-tablepicker-filtered-menu-info-bubble-aria-content","class":"waffle-dataconnector-tablepicker-filtered-menu-info-bubble-content"},ro(Ce(c)))));K8e(a.D)}function TDg(a){return Tc(a,function(b){return new LZ(b.getId(),b.getName())})}
function SDg(a,b,c){b=b.target.Sa();var d=b instanceof LZ?b.Rh():b.getValue();ex(a.La(),"waffle-bigquerydbsourcesettingsdialog-transition-out");a.D.P0("translateX(-24px)").then(function(){return a.resolve(new t8e(c,d,d,"db-source-table"))})};function UDg(a){a=a.Ul;var b='<div class="'+T("waffle-calculated-columns-description")+'">';b=b+'Calculated columns let you create new columns for better analysis by using Sheets functions and the current data in your connected sheet.<div class="'+(T("waffle-calculated-columns-tooltip")+'"></div></div><div class="'+T("waffle-calculated-columns-display-name-title")+'" id="waffle-calculated-columns-display-name-title">');b=b+"Calculated column name</div>"+((a?'<div class="'+T("waffle-calculated-columns-toggle-tabs")+
" "+T("waffle-gm-sidebar")+'"></div><div class="'+T("waffle-calculated-columns-column-menu-tab")+'"></div><div class="'+T("waffle-calculated-columns-function-menu-tab")+'"></div>':"")+R(c9e({ad:"waffle-calculated-columns-display-name-input",maxLength:50}))+'<div class="'+T("waffle-calculated-columns-display-name-error")+'"></div><div class="'+T("waffle-calculated-columns-formula-editor")+'"></div>');return S(b)};function VDg(){var a=S;var b=S('<svg class="waffle-calculated-columns-tooltip-help-icon" xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" viewBox="0 0 24 24" fill="#5F6368"><path fill="none" d="M0 0h24v24H0z"/><path d="M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z"/></svg>');return a('<div class="waffle-calculated-columns-tooltip-container"><div class="waffle-calculated-columns-tooltip-help-button">'+
b+"</div></div>")};function WDg(a,b){Q.call(this,b);this.H=new Gy(void 0,ey(Ey,"waffle-calculated-columns-tooltip-help-button"),this.qa());this.Ga(this.H);this.C=new sy(this.qa());this.va(this.C);this.D=null;this.va(this.D);this.F=null;this.O=a;this.L=Cy(xy(new wy,1))}u(WDg,Q);
WDg.prototype.Ca=function(){this.jb(Sx(VDg));this.H.Va(this.Fa("waffle-calculated-columns-tooltip-help-button"));this.C.Kc("waffle-calculated-columns-tooltip-help-bubble");this.C.Eq(!1);ty(this.C,!0);this.C.setPosition(1,2,0,-7);this.F=this.qa().Ca("A",{target:"_blank"},"Learn more");Le(this.F,"https://connectedsheets.page.link/calccolhelp");var a="="+(ritz_api.RitzModelApi.getLocalizedFunctionName("RIGHT")+"(orderId, 4)"),b="="+(ritz_api.RitzModelApi.getLocalizedFunctionName("YEAR")+"(startDate)"),
c="="+(ritz_api.RitzModelApi.getLocalizedFunctionName("IF")+"(units > 0, total/units, 0)");this.C.setContent(this.qa().Ca("DIV",void 0,this.qa().Ca("DIV","waffle-calculated-columns-tooltip-help-bubble-title",ro(Ce("Try these formulas"))),this.qa().Ca("DIV","waffle-calculated-columns-tooltip-help-bubble-subtitle",ro(Ce("Do basic math"))),this.qa().Ca("DIV","waffle-calculated-columns-tooltip-help-bubble-example",ro(Ce("=price * quantity"))),this.qa().Ca("DIV","waffle-calculated-columns-tooltip-help-bubble-subtitle",
ro(Ce("Manipulate text"))),this.qa().Ca("DIV","waffle-calculated-columns-tooltip-help-bubble-example",ro(Ce(a))),this.qa().Ca("DIV","waffle-calculated-columns-tooltip-help-bubble-subtitle",ro(Ce("Use dates"))),this.qa().Ca("DIV","waffle-calculated-columns-tooltip-help-bubble-example",ro(Ce(b))),this.qa().Ca("DIV","waffle-calculated-columns-tooltip-help-bubble-subtitle",ro(Ce("Apply conditional logic"))),this.qa().Ca("DIV","waffle-calculated-columns-tooltip-help-bubble-example",ro(Ce(c))),this.qa().Ca("DIV",
"waffle-calculated-columns-tooltip-help-bubble-link",this.F)));this.C.render();a=this.C.La();this.qa().ai(a,!0);Pw(a,"hidden",!1);this.C.setVisible(!1)};
WDg.prototype.Ia=function(){var a=this;Q.prototype.Ia.call(this);var b=this.Fa("waffle-calculated-columns-tooltip-help-button");this.C.Ti(this.qa().Zt(b));Sw(b,"Try these formulas");cz(b,"Support",void 0);IIe(b);this.getHandler().listen(this.H,"action",this.J).listen(this.C.getElement(),"keydown",this.R).listen(this.C,"hide",function(){return gx(a.La(),"waffle-calculated-columns-tooltip-help-bubble-visible")}).listen(this.F,"click",function(){a.O.C(36653,a.L)})};
WDg.prototype.R=function(a){27===a.keyCode&&(this.J(),this.Fa("waffle-calculated-columns-tooltip-help-button").focus())};WDg.prototype.J=function(){var a=!F6a(this.C.D);ix(this.La(),"waffle-calculated-columns-tooltip-help-bubble-visible",a);this.C.setVisible(a);Hf(this.D);a?(this.O.C(36652,this.L),this.D=new tB(this.C.La(),this.qa()),this.va(this.D),uB(this.D),this.C.getElement().focus()):this.Fa("waffle-calculated-columns-tooltip-help-button").blur()};function XDg(a,b){this.D=b;this.C=new Map;YDg(this,a)}function ZDg(a){return a.replace(/^[\t\r\n]+|[\t\r\n]+$/g,"").replace(/[\t\r\n]+/g," ")}function YDg(a,b){b=b.map(function(c){return iM(c)});a.C=new Map(b.map(function(c){return[NJ(c,a.D),c]}))}function $Dg(a){var b=[];a.C.forEach(function(c,d){dg(c,2)||b.push(d)});return b}function aEg(a){var b=[];a.C.forEach(function(c,d){b.push(d)});return b};function bEg(a){a=a.Agb;return S('<div class="waffle-calculated-columns-formula-editor-container"><div class="waffle-calculated-columns-formula-editor-input-container"><textarea class="'+T("waffle-calculated-columns-formula-editor-input")+'" spellcheck="false" placeholder="'+T(a)+'"></textarea></div></div>')};function cEg(a,b,c){b=c||b;return S('<div class="'+T("waffle-calculated-columns-validation-widget")+'"><div class="'+T("waffle-calculated-columns-validation-widget-open-button")+'"><div class="'+T("waffle-calculated-columns-validation-widget-spinner")+'">'+R(dPe({Xb:!0},b))+"</div>"+R(ZNe())+R(ixc(null))+R(YNe())+'</div><div class="'+T("waffle-calculated-columns-validation-widget-bar")+'"><div class="'+T("waffle-calculated-columns-validation-widget-spinner")+'">'+R(dPe({Xb:!0},b))+"</div>"+R(ZNe())+
R(ixc(null))+R(YNe())+'<div class="'+T("waffle-calculated-columns-validation-widget-message")+'"></div><div class="'+T("waffle-calculated-columns-validation-widget-close-button")+'">'+R(WNe(null,b))+"</div></div></div>")};function dEg(a,b,c){Q.call(this,c);this.H=a;this.L=b;this.J=Cy(xy(new wy,1));this.D=new Gy(void 0,ey(Ey,"waffle-calculated-columns-validation-widget-open-button"),this.qa());this.Ga(this.D);this.C=new Gy(void 0,ey(Ey,"waffle-calculated-columns-validation-widget-close-button"),this.qa());this.Ga(this.C);this.F=!1}u(dEg,Q);dEg.prototype.Ca=function(){this.jb(Sx(cEg));this.C.Va(this.Fa("waffle-calculated-columns-validation-widget-close-button"));this.D.Va(this.Fa("waffle-calculated-columns-validation-widget-open-button"))};
dEg.prototype.Ia=function(){var a=this;Q.prototype.Ia.call(this);this.D.Od("Show the formula validation widget");this.C.Od("Close the formula validation widget");this.D.Na(this.H);this.D.setVisible(this.H);this.getHandler().listen(this.C,"action",function(){return a.setVisible(!1)}).listen(this.D,"action",function(){a.setVisible(!0);a.L.C(36654,a.J);var b=a.Fa("waffle-calculated-columns-validation-widget-message");RK(Go(b))});eEg(this)};
dEg.prototype.setVisible=function(a){this.F=a;this.Gb()&&ix(this.La(),"waffle-calculated-columns-validation-widget-visible",this.F)};dEg.prototype.isVisible=g("F");
function eEg(a){gx(a.La(),"waffle-calculated-columns-validation-widget-valid");gx(a.La(),"waffle-calculated-columns-validation-widget-invalid");gx(a.La(),"waffle-calculated-columns-validation-widget-loading");var b="Try this example: ="+(ritz_api.RitzModelApi.getLocalizedFunctionName("ROUND")+"(<BigQueryColumnName>, 2) * 5");fEg(a,b);a.D.Od("Show the formula validation widget")}function fEg(a,b){var c=a.Fa("waffle-calculated-columns-validation-widget-message");b=Ce(b);Je(c,b);a.F&&RK(Go(c))};function gEg(a,b,c,d,e,f,h,k){Q.call(this,k);this.R=a;this.xa=b;this.Ha=c;this.ma=d;this.C=new oZ("");this.va(this.C);this.H=this.J=null;this.O=!1;this.F=new dEg(d,h,this.qa());this.Ga(this.F);this.Ka=f;this.V=this.L=!1;this.Ea=e;this.D=h;this.Ba=Cy(xy(new wy,1))}u(gEg,Q);p=gEg.prototype;p.Ca=function(){Q.prototype.Ca.call(this);this.jb(Sx(bEg,{Agb:"=Write formula here"}))};
p.Ia=function(){Q.prototype.Ia.call(this);this.C.zR(255);var a=this.Fa("waffle-calculated-columns-formula-editor-input");this.C.Va(a);Pw(a,"label","Formula editor");this.J=new eB(a);this.F.render(this.La());this.ma&&(this.H=new ox(this.C.getElement()),this.getHandler().listen(this.J,"input",this.N2).listen(this.H,"focusin",this.KUb).listen(this.H,"focusout",this.LUb));null!=this.xa&&(this.C.setValue(ritz_api.BigSheetsApi.getCalculatedColumnFormulaString((new Mk).serialize(this.xa),this.R)),this.N2());
this.C.Na(this.ma)};p.vd=function(){Q.prototype.vd.call(this);Hf(this.J)};p.KUb=function(){Vw(this.La(),"waffle-calculated-columns-formula-editor-container-invalid")||ex(this.La(),"waffle-calculated-columns-formula-editor-container-focus")};p.LUb=function(){gx(this.La(),"waffle-calculated-columns-formula-editor-container-focus")};
p.N2=function(){if(this.L)this.V=!0,hEg(this);else{var a=this.Ea.getRitzCalculatedColumnFormulaValidationResult(this.R,iEg(this),aEg(this.Ha));a=(new Mk).Tc(ubc.Aa(),a);switch(a.getStatus()){case 4:this.D.C(36699);break;case 12:this.D.C(36701);break;case 7:var b=new kqe;var c=dg(a,5)?D(a,5):"CUSTOM_OR_NON_ENGLISH_FUNCTION";b=M(b,1,c);c=new Ej;b=cj(c,27,b);b=Cy(By(xy(new wy,1),b));this.D.C(36700,b)}1!=a.getStatus()?(a=D(a,4),jEg(this,!1,a)):(a=D(a,2),0==jg(a,1).length?jEg(this,!0,null):kEg(this,a))}};
function kEg(a,b){a.L=!0;hEg(a);var c=new rbc;E(c,2,a.R);E(c,1,b);ADg(eM.getInstance(),c,a.Ka).then(function(d){d=d.Bi();3==d.getState()?(d="BigQuery error: "+D(d,3),jEg(a,!1,d)):jEg(a,!0,null);lEg(a)},function(){jEg(a,!1,"Formula validation failed");lEg(a)})}function lEg(a){a.L=!1;a.V&&(a.V=!1,a.N2())}
function jEg(a,b,c){a.O=b;if("="==Cd(iEg(a)))gx(a.La(),"waffle-calculated-columns-formula-editor-container-invalid"),eEg(a.F);else{ix(a.La(),"waffle-calculated-columns-formula-editor-container-invalid",!b);b&&Ro(a.qa())==a.C.getElement()&&ex(a.La(),"waffle-calculated-columns-formula-editor-container-focus");var d=a.F;gx(d.La(),"waffle-calculated-columns-validation-widget-loading");ix(d.La(),"waffle-calculated-columns-validation-widget-valid",b);ix(d.La(),"waffle-calculated-columns-validation-widget-invalid",
!b);b?c=b="Formula is valid":(b=c,c="Formula is invalid. Click for more detail.");fEg(d,b);d.D.Od(c)}a.dispatchEvent(new mEg("validation-update"))}function iEg(a){a=a.C.getValue();return AF(Lga(a))?a:"="+a}
function hEg(a){a.O=!1;a.dispatchEvent(new mEg("validation-update"));gx(a.La(),"waffle-calculated-columns-formula-editor-container-invalid");a=a.F;ex(a.La(),"waffle-calculated-columns-validation-widget-loading");gx(a.La(),"waffle-calculated-columns-validation-widget-valid");gx(a.La(),"waffle-calculated-columns-validation-widget-invalid");a.F&&fEg(a,"");a.D.Od("Show the formula validation widget")}function mEg(a,b){Kn.call(this,a,b)}u(mEg,Kn);function nEg(a,b,c){b=c||b;c=a.description;return S(R(b6e({gY:"",match:"",fY:a.label},b))+oEg({gY:"",match:"",fY:c},b))}function oEg(a){var b=a.gY,c=a.match;a=a.fY;return S('<span class="'+T("waffle-function-filtered-menu-item-description")+'"><span>'+R(b)+'</span><span class="'+T("waffle-function-filtered-menu-item-description-match")+'">'+R(c)+"</span><span>"+R(a)+"</span></span>")};function pEg(a,b,c){d6e.call(this,a,b,c,new qEg)}u(pEg,d6e);pEg.prototype.Ia=function(){d6e.prototype.Ia.call(this);this.Kc("waffle-function-filtered-menu-item")};pEg.prototype.Je=function(){return this.Sa().tX};
pEg.prototype.C=function(a){a=void 0===a?"":a;var b=this.Hg();if(b){b=b.match(new RegExp($e(a),"i"));var c=this.Je().match(new RegExp($e(a),"i"));this.setVisible(""===a||!!b||!!c);e6e(this,b?b.index:0,b?a.length:0);b=c?c.index:0;c=c?a.length:0;a=this.qa();c=b+c;var d=this.Je();b=Rx(oEg,{gY:d.substring(0,b),match:d.substring(b,c),fY:d.substring(c,d.length)});c=a.Fa("waffle-function-filtered-menu-item-description",this.La());a.uB(b,c)}else this.setVisible(!a)};
function qEg(){Jy.apply(this,arguments)}u(qEg,Jy);qEg.prototype.Ca=function(a){a=a.Sa();var b=Sx(nEg,{label:a.getName(),description:a.tX});this.ue(b,a.getName()+". "+a.tX);return b};ta(qEg);function rEg(){pY.apply(this,arguments)}u(rEg,pY);rEg.prototype.Ca=function(){pY.prototype.Ca.call(this);ex(this.La(),"waffle-function-filtered-menu")};rEg.prototype.Ia=function(){pY.prototype.Ia.call(this);qY(this).setAttribute("placeholder","Search");Qy(this,!1)};rEg.prototype.eg=ba();function sEg(a,b,c,d,e){SK.call(this,153);this.L=a;this.O=b;this.J=c||"";this.F=d;this.C=e}u(sEg,SK);sEg.prototype.Id=function(){var a=new nLb;E(a,1,this.L);E(a,4,this.O);E(a,3,this.J);E(a,2,this.F);for(var b=0;b<this.C.length;b++)fg(a,5,this.C[b]);return a};function tEg(a,b,c,d,e,f,h,k,l,n){$A.call(this);this.xa=a;this.Me=new WDg(n,this.qa());this.Ga(this.Me);this.V=b;if(null==b)b=null;else{var q=new Bg;E(q,2,b);b=q}this.ma=b;this.$a=c;this.Qa=d;this.fb=e;this.L=f;this.C=new dU("Enter name");this.Ha=null;this.H=new gEg(a,this.ma,d,f,k,l,n,this.qa());this.Ga(this.H);this.R=this.O=this.F=null;f&&(this.F=new xZ(void 0,this.qa()),this.O=new rEg(void 0,this.qa()),this.R=new BZ("Columns","Functions",!0,this.qa()),this.Ga(this.F),this.Ga(this.O),this.Ga(this.R));
this.Za=h;this.Wa=n;this.Ta=Cy(xy(new wy,1))}u(tEg,$A);p=tEg.prototype;p.Ja=function(){$A.prototype.Ja.call(this)};
p.Ca=function(){$A.prototype.Ca.call(this);var a=null==this.V?"Add calculated column":this.L?"Edit calculated column":"View calculated column";this.setTitle(a);ex(xx(this),"waffle-calculated-columns-dialog");var b=new Ax;b.set("cancel","Cancel",!1,!0);this.L&&b.set("save",null==this.V?"Add":"OK",!0,!1);Dx(this,b);Ox(this,"save");(b=Q6a(this))&&Sw(b,a);a=Sx(UDg,{Ul:this.L});b=this.Hb();this.qa().appendChild(b,a);this.Me.render(this.Fa("waffle-calculated-columns-tooltip"));this.H.render(this.Fa("waffle-calculated-columns-formula-editor"))};
p.Ia=function(){$A.prototype.Ia.call(this);ix(xx(this),"waffle-calculated-columns-dialog-view-only",!this.L);var a=this.qa().Fa("waffle-calculated-columns-display-name-input");this.C.Va(a);this.C.Na(this.L);this.Ha=new eB(a);var b=this.qa().Fa("waffle-calculated-columns-display-name-title");Pw(a,"labelledby",b.id);null!=this.ma&&(this.C.setValue(NJ(this.ma,this.xa)),this.ELa());this.hAa();if(this.L){a=this.Fa("waffle-calculated-columns-column-menu-tab");this.R.D=a;a=this.Fa("waffle-calculated-columns-function-menu-tab");
this.R.F=a;this.R.render(this.Fa("waffle-calculated-columns-toggle-tabs"));this.F.render(this.Fa("waffle-calculated-columns-column-menu-tab"));this.O.render(this.Fa("waffle-calculated-columns-function-menu-tab"));qY(this.F).setAttribute("placeholder","Search");Qy(this.F,!1);a=ia(this.$a);for(b=a.next();!b.done;b=a.next())b=b.value,dg(iM(b),2)||j6e(this.F,b,this.xa);b=Zdc(this.fb,!1,!1,!0);a=this.O;b=ia(b);for(var c=b.next();!c.done;c=b.next()){var d=c.value;c=a;var e=d.getName();d=new pEg(e,d,c.qa());
c.Ga(d,!0)}this.getHandler().listen(this,"dialogselect",this.JUb).listen(this.Ha,"input",this.ELa).listen(this.H,"validation-update",this.hAa).listen(this.F,"action",this.cob).listen(this.O,"action",this.stb)}};p.vd=function(){$A.prototype.vd.call(this);Hf(this.Ha)};
p.JUb=function(a){var b=this;if("save"==a.key){if(a=iEg(this.H),!Bd(a)){var c=null==this.V;a=new sEg(this.xa,ZDg(this.C.getValue()),this.V,a,$Dg(this.Qa));var d=c?36645:36647,e=c?36644:36646;TK(a,function(f){b.Wa.C(f?e:d,b.Ta);f&&b.dispatchEvent(new uEg("update",b.xa,c))});this.Za.C(a)}}else"cancel"==a.key&&this.Wa.C(36643,this.Ta)};
p.cob=function(a){var b=a.target.Hg();a=this.H;b=Ujc(b);var c=a.C.getElement().selectionStart,d=a.C.getElement().selectionEnd,e=a.C.getValue(),f=c+b.length;a.C.setValue(e.slice(0,c)+b+e.slice(d));a.C.getElement().setSelectionRange(f,f);a.N2();a.D.C(36732,a.Ba)};
p.stb=function(a){var b=a.target.getValue().getName();a=this.H;var c=a.C.getElement().selectionStart,d=a.C.getElement().selectionEnd,e=a.C.getValue();b=b+"("+e.slice(c,d)+")";e=e.slice(0,c)+b+e.slice(d);b=c+b.length;c==d&&--b;c=b;a.C.setValue(e);a.C.getElement().setSelectionRange(c,c);a.N2();a.D.C(36733,a.Ba)};
p.ELa=function(){var a=vEg(this);ix(this.C.getElement(),"waffle-calculated-columns-display-name-input-invalid",!!a);var b=a?a:"";a=this.Fa("waffle-calculated-columns-display-name-error");b=Ce(b);Je(a,b);RK(Go(a));this.hAa()};p.hAa=function(){var a=this.L&&!vEg(this)&&!Te(this.C.getValue())&&this.H.O;Fx(this.D,"save",a)};
function vEg(a){if(Te(a.C.getValue()))var b=null;else a:{b=a.Qa;var c=a.C.getValue();a=a.ma;c=ZDg(c);if(Bd(c))b="Calculated column name cannot be empty";else{for(var d=ia(b.C.keys()),e=d.next();!e.done;e=d.next())if(e=e.value,Ad(e,c))if(d=null!=a,b=b.C.get(e),d&&a.equals(b))break;else{b="A column named "+(c+" already exists");break a}b=null}}return b}function uEg(a,b,c){Kn.call(this,a);this.Ms=b;this.C=c}u(uEg,Kn);function wEg(a,b,c,d,e,f){jY.call(this,a,b,c,new kNe,"db",d,e,f);this.C="";this.R=!0}u(wEg,jY);p=wEg.prototype;p.Ia=function(){jY.prototype.Ia.call(this);this.Pca()};p.Ez=function(){return HJ(this.J.C)&&Ic(z(),"feda")?jY.prototype.Ez.call(this):!1};p.Na=function(a){this.Gb()&&(!this.R&&Ic(z(),"fedaic")?jY.prototype.Na.call(this,!1,"This data table is not yet enabled for Answers by your data table admin"):jY.prototype.Na.call(this,a))};p.XKa=function(){HMe(null,null,this.C,this.D)};
p.hOa=function(a){HMe(a,null,this.C,this.D)};p.R2=function(){var a=jY.prototype.R2.call(this);a&&this.Ez()&&this.$Y();return a};function xEg(a,b){a.C!=b&&(a.C=b,Ic(z(),"fedaic")?zDg(eM.getInstance(),a.C).then(function(c){c=0==c.getError();a.R=c;a.Na(a.R);a.Ez()&&a.$Y()},function(){a.R=!1;a.Na(a.R);a.mD()}):a.Ez()&&a.$Y())}
p.$Y=function(){if(this.C&&this.R){if(!lob.isVisible()&&!Onb.isVisible()&&this.Ez()){var a=this.V;a.F=this.C;var b=eM.getInstance();b.D=a;b.C&&b.D.nD(b.C);a.EY([])}}else this.mD();IMe(null,this.C,this.D)};p.mD=function(){jY.prototype.mD.call(this);this.C="";IMe(null,null,this.D)};function yEg(a){var b=a.label;a=a.oh;return S((a?'<div class="'+T("goog-menuitem-icon")+" "+T("waffle-charteditor-column-filtered-menu-item-icon")+" "+T(a)+'"></div>':"")+'<span class="'+T("waffle-datasource-configbar-columns-menu-item-label")+'">'+R(b)+"</span>")}function zEg(){return S('<div class="'+T("waffle-datasource-configbar-columns-menu-spinner-container")+'"></div>')};function AEg(a){Py.call(this,a);this.le=new xX(!1);this.va(this.le);this.C=new Ky(Sx(zEg),void 0,this.qa());this.C.mz(!1);this.Ga(this.C)}u(AEg,Py);AEg.prototype.Ia=function(){Py.prototype.Ia.call(this);ex(this.La(),"waffle-datasource-configbar-columns-menu")};AEg.prototype.Ca=function(){Py.prototype.Ca.call(this);this.C.render(this.La());this.le.render(this.C.Fa("waffle-datasource-configbar-columns-menu-spinner-container"))};
AEg.prototype.D=function(a,b){a=ia(a);for(var c=a.next();!c.done;c=a.next()){var d=c.value;c=$cc(d,b);null!==c&&(d=h6e(d.getType()),this.Ga(new Ky(Sx(yEg,{label:c,oh:d}),void 0,this.qa()),!0))}};function BEg(a,b){var c=a.C.getElement();c&&(ix(c,"waffle-datasource-configbar-columns-menu-loading",b),P(c,b),a.le.setActive(b))};function CEg(){Py.apply(this,arguments)}u(CEg,Py);CEg.prototype.Ia=function(){Py.prototype.Ia.call(this);ex(this.La(),"waffle-datasource-configbar-formula-menu")};CEg.prototype.ow=function(a){var b=this;this.Ga(a,!0);this.getHandler().listen(a,"action",function(){var c=new VH("insert-formula-function");c.ma=a.getValue();b.dispatchEvent(c)})};function DEg(a){Py.call(this,a,new EEg)}u(DEg,Py);DEg.prototype.ow=function(a){this.Ga(a,!0)};function EEg(){Ny.call(this)}u(EEg,Ny);EEg.prototype.HF=function(a){a=Ny.prototype.HF.call(this,a);a.push("waffle-dbsource-configbar-overflow-menu");return a};function FEg(a,b,c){b=c||b;a='<div class="'+T("waffle-dbsource-configbar-wrapper")+'"><div class="'+T("waffle-dbsource-configbar")+'"><div class="'+T("waffle-dbsource-configbar-header")+'"><div class="'+T("waffle-dbsource-configbar-header-icon")+'">'+R(XNe({color:"#5f6368",Rra:24},b))+'</div><div class="waffle-dbsource-configbar-header-title" role="textbox" tabindex="0" aria-label="';a+=Cw("Connected sheet name");a+='"></div><div class="waffle-dbsource-configbar-header-subtitle"></div><div class="'+
T("waffle-dbsource-configbar-options-wrapper")+'"><div class="'+T("waffle-dbsource-configbar-watch-tutorial-button-wrapper")+'"></div><div class="'+T("waffle-dbsource-configbar-send-feedback-button-wrapper")+'"></div><div class="'+T("waffle-dbsource-configbar-overflow-menu-button-wrapper")+'"></div></div></div><div class="'+T("waffle-dbsource-configbar-actions")+'"><div class="'+T("waffle-dbsource-configbar-columns-menu-button-wrapper")+'"></div><div class="'+T("waffle-dbsource-configbar-button-wrapper")+
" "+T("waffle-dbsource-configbar-chart-button-wrapper")+'"></div><div class="'+T("waffle-dbsource-configbar-button-wrapper")+" "+T("waffle-dbsource-configbar-pivot-button-wrapper")+'"></div><div class="'+T("waffle-dbsource-configbar-button-wrapper")+" "+T("waffle-dbsource-configbar-function-button-wrapper")+'"></div><div class="'+T("waffle-dbsource-configbar-separator")+'"></div><div class="'+T("waffle-dbsource-configbar-button-wrapper")+" "+T("waffle-dbsource-configbar-table-button-wrapper")+'"></div><div class="'+
T("waffle-dbsource-configbar-answers-wrapper")+'"></div></div></div></div>';return S(a)}
function GEg(){var a=S('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><g fill="#188038" fill-rule="nonzero"><path d="M14.5263158 2C15.3368421 2 16 2.7 16 3.55555556V14.4444444C16 15.3 15.3368421 16 14.5263158 16H3.47368421C2.66315789 16 2 15.3 2 14.4444444V3.55555556C2 2.7 2.66315789 2 3.47368421 2H14.5263158zM3.5 3.5v11h11v-11h-11z"/><path d="M6.75 12.75h-1.5V7.5h1.5zM9.75 12.75h-1.5v-7.5h1.5zM12.75 12.75h-1.5v-3h1.5z"/></g></svg>');a=R(a)+"<span>";return S(a+
"Chart</span>")}function HEg(){var a=S('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><path fill="#188038" fill-rule="evenodd" d="M10 13h1.185c.9975 0 1.815-.81 1.815-1.815V10h-2.25l3-3 3 3H14.5v1.185c0 1.83-1.485 3.315-3.315 3.315H10v2.25l-3-3 3-3V13zM8 6V2h6.5454545C15.3454545 2 16 2.72 16 3.6V6H8zM2 6V3.6C2 2.72 2.72 2 3.6 2H6v4H2zm1.6 10c-.88 0-1.6-.6545455-1.6-1.4545455V8h4v8H3.6z"/></svg>');a=R(a)+"<span>";return S(a+"Pivot table</span>")}
function IEg(){var a=R(D9e())+"<span>";return S(a+"Extract</span>")}function JEg(){var a=S('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><path fill="#188038" d="M15 2H3v1.75L8.143 9 3 14.25V16h12v-2.625H7.286L11.571 9 7.286 4.625H15z"/></svg>');a=R(a)+"<span>";return S(a+"Function</span>")}
function KEg(){var a=S;var b=S('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/></svg>');return a(R(b))}
function LEg(){var a='<span class="'+T("waffle-dbsource-configbar-secondary-button-content")+'">';var b=S('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path fill="#80868b" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-2-3.5l6-4.5-6-4.5z"/><path fill="none" d="M0 0h24v24H0V0z"/></svg>');a=a+R(b)+"<span>";return S(a+"Watch tutorial</span></span>")}
function MEg(){var a='<span class="'+T("waffle-dbsource-configbar-secondary-button-content")+'">';var b=S('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path fill="#80868b" d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17l-.59.59-.58.58V4h16v12zm-9-4h2v2h-2zm0-6h2v4h-2z"/><path fill="none" d="M0 0h24v24H0V0z"/></svg>');a=a+R(b)+"<span>";return S(a+"Send feedback</span></span>")};function NEg(a){this.bd=a}NEg.prototype.Xf=g("bd");function OEg(a,b,c,d,e,f,h){Q.call(this,h);this.R=a;this.ma=b;this.O=c;this.Wa=d;this.L=b.xa;this.Ta=f;this.C=new JP("Columns",new AEg(this.qa()),void 0,this.qa());this.C.Kc("waffle-dbsource-configbar-columns-menu-button");this.C.Hi(!0);this.Ga(this.C);this.xa=PEg(this,"waffle-dbsource-configbar-chart-button",Sx(GEg));this.Ba=PEg(this,"waffle-dbsource-configbar-pivot-button",Sx(HEg));this.V=PEg(this,"waffle-dbsource-configbar-table-button",Sx(IEg));a=Sx(JEg);this.J=new Xy(a,new CEg(this.qa()),mwd.getInstance(),
this.qa());this.J.Kc("waffle-dbsource-configbar-function-button");this.J.Hi(!0);this.J.zo(!0);this.Ga(this.J);this.Oa=PEg(this,"waffle-dbsource-configbar-secondary-button",Sx(LEg));this.Pa=PEg(this,"waffle-dbsource-configbar-secondary-button",Sx(MEg));this.Za=new Ky("Connection settings","settings");this.Ea=new Ky(SC.getLabel(),"add-calculated-column");this.Ka=new Ky(RC.getLabel(),"show-refresh-all");this.F=new JP(Sx(KEg),new DEg(this.qa()),void 0,this.qa());this.F.Kc("waffle-dbsource-configbar-overflow-menu-button");
this.F.zo(!0);this.Ga(this.F);this.Qa=new Map([[this.C,""],[this.xa,"chart"],[this.Ba,"pivot table"],[this.V,"table"],[this.J,"function"]]);this.Ha=new Map([[this.C,"fedsccm"],[this.xa,"fedbc"],[this.Ba,"fedp"],[this.V,"fedr"],[this.J,"fedf"]]);this.D=null;Ic(z(),"feda")&&(this.D=new wEg(this.ma,this.O,this.Wa,e,75,this.qa()),this.Ga(this.D));this.H=null}u(OEg,Q);p=OEg.prototype;p.Ca=function(){this.jb(Sx(FEg))};
p.Ia=function(){Q.prototype.Ia.call(this);var a=i6e();a&&this.F.Kc(a);this.C.render(this.Fa("waffle-dbsource-configbar-columns-menu-button-wrapper"));this.xa.render(this.Fa("waffle-dbsource-configbar-chart-button-wrapper"));this.Ba.render(this.Fa("waffle-dbsource-configbar-pivot-button-wrapper"));this.V.render(this.Fa("waffle-dbsource-configbar-table-button-wrapper"));this.J.render(this.Fa("waffle-dbsource-configbar-function-button-wrapper"));this.F.render(this.Fa("waffle-dbsource-configbar-overflow-menu-button-wrapper"));
this.Oa.render(this.Fa("waffle-dbsource-configbar-watch-tutorial-button-wrapper"));this.Pa.render(this.Fa("waffle-dbsource-configbar-send-feedback-button-wrapper"));this.D&&this.D.Va(this.Fa("waffle-dbsource-configbar-answers-wrapper"));this.H=this.Fa("waffle-dbsource-configbar-header-title");this.getHandler().listen(this.xa,"action",this.Ymb).listen(this.Ba,"action",this.gAb).listen(this.V,"action",this.MFb).listen(this.J,"show",this.Gpb).listen(this.C,"show",this.fob).listen(this.R,"na",this.aUb).listen(this.H,
["focus","mousedown"],this.Yxb).listen(this.F,"show",this.nzb).listen(this.F.Ob(),"action",this.pzb).listen(this.Pa,"action",this.gDb).listen(this.Oa,"action",function(){return Jpb.wb()});this.D?this.getHandler().listen(this.D.getElement(),"keydown",this.QSa):this.getHandler().listen(this.V.getElement(),"keydown",this.QSa);this.Ha.forEach(function(b,c){Ic(z(),b)||c.Na(!1)});Ic(z(),"fedsccm")||this.C.setVisible(!1);cz(this.F.La(),"More options",void 0);this.refresh()};
p.QSa=function(a){9===a.keyCode&&(a.preventDefault(),this.dispatchEvent(new QEg))};p.setVisible=function(a){P(this.La(),a);if(this.D){a="";var b=dR(this.R);b&&b.Xf()&&(a=b.Xf());xEg(this.D,a)}};p.isVisible=function(){return cw(this.La())};
p.refresh=function(){REg(this,dR(this.R).Zd());var a=this.Fa("waffle-dbsource-configbar-header-subtitle"),b=SEg(this);b?(b+=" Rows",this.qa().Ke(a,b)):this.qa().Ke(a,"");a=hM(this.ma.H)||this.ma.Ld()||CGe(this.L,TEg(this));UEg(this,!a);this.C.Fd(!1);VEg(this);this.D&&xEg(this.D,TEg(this));this.F&&(a=0!=WEg(this).length,this.F.Na(a),this.F.setVisible(a))};function PEg(a,b,c){c=new pT(c,a.qa());c.Kc(b);a.Ga(c);return c}p.Ymb=function(){ddc(this.L);i2b(null,void 0,TEg(this));this.O.C(36528,XEg())};
p.gAb=function(){ddc(this.L);var a=new xh,b=TEg(this);E(a,1,b);b=DMe();E(b,15,a);Ic(z(),"fedpos")&&E(b,17,!1);a=EMe(b);a=new NQe(null,IYb(a),void 0);b2b(a);this.O.C(36527,XEg())};p.MFb=function(){ddc(this.L);l2b(TEg(this));this.O.C(36529,XEg())};p.Gpb=function(){var a=this.J.Ob();if(a&&0==a.rc()){a=this.J.Ob();var b=aNd(new $Md(this.ma.Ta,a,this.Ta),void 0,!0);b=ia(b);for(var c=b.next();!c.done;c=b.next())a.ow(c.value)}ddc(this.L)};
p.Yxb=function(a){var b=Ic(z(),"fedcr");this.H.isContentEditable||FN(this.ma)||!b||(this.H.contentEditable=!0,"focus"===a.type&&(a=window.getSelection(),b=document.createRange(),b.selectNodeContents(this.H),a.removeAllRanges(),a.addRange(b)),this.getHandler().listen(this.H,"keydown",this.$Tb).listen(this.H,"blur",this.XDb))};p.$Tb=function(a){switch(a.keyCode){case 13:YEg(this);break;case 27:ZEg(this,!0)}};p.XDb=function(){window.getSelection().removeAllRanges();YEg(this)};
function YEg(a){a.dispatchEvent(new $Eg(dR(a.R).ib(),Ho(a.H)));ZEg(a,!1)}function ZEg(a,b){a.H.contentEditable=!1;Vn(a.H,"keydown");Vn(a.H,"blur");b&&REg(a,dR(a.R).Zd())}p.nzb=function(){for(var a=this.F.Ob();0<a.rc();)a.Rm(0,!0);WEg(this).forEach(function(b){return a.ow(b)})};function WEg(a){var b=[];Gpb.isEnabled()&&b.push(a.Za);Ic(z(),"fedcc")&&SC.isEnabled()&&b.push(a.Ea);Ic(z(),"fedors")&&RC.isEnabled()&&b.push(a.Ka);return b}
p.pzb=function(a){switch(a.target.Sa()){case "settings":Gpb.wb(new NEg(TEg(this)));break;case "add-calculated-column":this.O.C(36651,XEg());SC.wb();break;case "show-refresh-all":this.O.C(36705,XEg()),RC.wb()}};p.gDb=function(){(ct(),Qu).wb({source:"big-sheets-feedback"})};p.fob=function(){var a=this,b=this.C.Ob();BEg(b,!0);var c=TEg(this);jM(this.L,c).then(function(d){VEg(a);0<d.length?b.D(d,c):(a.C.Fd(!1),a.refresh())})};p.aUb=function(a){REg(this,a.xm)};
function REg(a,b){var c=a.Fa("waffle-dbsource-configbar-header-title");a.qa().Ke(c,b)}
function UEg(a,b){var c=SEg(a);a.Qa.forEach(function(d,e){var f=!a.Ha.has(e)||Ic(z(),a.Ha.get(e));e.Na(f&&b);var h;b&&e==a.V?h="Insert an extract of up to 50k rows to a different sheet":h=b&&c&&d?"Insert "+(d+(" based on "+(c+" rows"))):b&&d?"Insert "+d:b?"":"You don't have permission or access to refresh or edit analysis with this connected data.";cz(e.La(),h,void 0);h&&uHd(e.La(),"waffle-dbsource-configbar-db-object-creation-button-tooltip")});a.D&&a.D.Na(b);a.Ea&&a.Ea.Na(b);a.Ka&&a.Ka.Na(b)}
function TEg(a){return dR(a.R).Xf()}function VEg(a){a=a.C.Ob();for(BEg(a,!1);1<a.rc();)a.Rm(1,!0)}function SEg(a){return(a=ritz_api.BigSheetsApi.getDatasourceTotalRowCount(TEg(a)))?yxc.format(parseInt(a,10)):null}function XEg(){var a=Gj(new Ej,!0);return Cy(By(xy(new wy,75),a))}function $Eg(a,b){Kn.call(this,"datasheet-rename");this.lh=a;this.name=b}u($Eg,Kn);function QEg(){Kn.call(this,"configbar-dom-focus-out")}u(QEg,Kn);function aFg(a,b,c,d,e,f,h,k,l){Wn.call(this);this.D=a;this.F=b;this.R=l;this.L=c;this.ma=d;this.O=e;this.H=f;this.J=h;this.V=k;this.Ma=new Xn(this);this.va(this.Ma);this.C=null;this.Ma.listen(this.D,["ga","ya"],this.LNa).listen(this.D,["ha","xa"],this.GDb).listen(this.F,["acl_change","offline_status","readonly_status"],this.skb);this.LNa()}u(aFg,Wn);p=aFg.prototype;
p.LNa=function(){var a=dR(this.D);a&&nH(a)&&(this.C?this.C.refresh():(this.C=new OEg(this.D,this.F,this.L,this.ma,this.V,this.R),a=this.C.qa(),this.C.render(a.getElement("waffle-dbsource-configbar-id")),this.C.Ud(this),this.Ma.listen(this.C,"insert-formula-function",this.xEb).listen(this.C,"datasheet-rename",this.vpb).listen(this.C,"configbar-dom-focus-out",this.Aob)),this.C.setVisible(!0),EJd())};p.vpb=function(a){var b=this;a=new HMc(a.lh,a.name);TK(a,function(c){c||ZEg(b.C,!0)});this.J.C(a)};
p.Aob=function(){jQ(XK(this.H))};p.xEb=function(a){var b=this,c=dR(this.D),d=c.Xf();if(d){var e=c.Zd(),f=a.ma;zHe(this.O,function(h,k){var l=ritz_api.BigSheetsApi.getDatasourceReferenceString(e,null);rCa([jM(b.F.xa,d),kp(1E3)]).then(function(){return bFg(b,f,l,k)})},"Insert Formula");this.L.C(36535,XEg())}};
function bFg(a,b,c,d){if(d)a.F.C.cB(d.$i,function(){var f=JJ(a.F.C),h=new bm(d.C,d.Sj);vK(f,h);cFg(a,b,c,h)});else{var e=new yEd(3,BJ(a.F.C)+1);TK(e,function(f){f&&cFg(a,b,c,new bm)});a.J.C(e)}}function cFg(a,b,c,d){xp(yJ(ZK(a.H).C,wm(d)),function(){yGd(XK(a.H),b,c)})}p.GDb=function(){this.C&&this.C.setVisible(!1)};p.skb=function(){var a=dR(this.D);a&&nH(a)&&this.C&&this.C.refresh()};p.Ja=function(){Wn.prototype.Ja.call(this);Hf(this.C)};function dFg(){var a='<div class="'+T("waffle-create-datasheet-welcome-dialog-section")+'"><img src="//ssl.gstatic.com/docs/spreadsheets/bigSheets_welcome.png" class="'+T("waffle-create-datasheet-welcome-dialog-image")+'" alt=""><h3 class="'+T("waffle-create-datasheet-welcome-dialog-welcome-message")+'"><span>';a=a+'Connect and analyze big data in Sheets</span></h3><div class="'+(T("waffle-create-datasheet-welcome-dialog-welcome-description")+'">');a=a+"Connect to BigQuery, Google's cloud data warehouse, to analyze and share billions of rows of data with your colleagues - all within Sheets</div><div class=\""+
(T("waffle-create-datasheet-welcome-dialog-button-wrapper")+'"></div></div>');return S(a)};function eFg(a){NZ.call(this,"waffle-create-datasheet-welcome-dialog",a);this.F=new pT("Learn the basics",this.qa());this.Ga(this.F);this.D=new FB("Get connected",this.qa());this.Ga(this.D)}u(eFg,NZ);p=eFg.prototype;
p.Ca=function(){NZ.prototype.Ca.call(this);Qx(this.Hb(),dFg);this.F.render(this.Fa("waffle-create-datasheet-welcome-dialog-button-wrapper"));this.getHandler().listen(this.F,"action",this.bUb);this.D.render(this.Fa("waffle-create-datasheet-welcome-dialog-button-wrapper"));this.getHandler().listen(this.D,"action",this.RSa);Ow(this.Fa("waffle-dataconnector-modal-title"));var a=this.Fa("waffle-create-datasheet-welcome-dialog-welcome-message");a.id=nw(this,"waffle-create-datasheet-welcome-dialog-welcome-message");
Nw(a,"heading");Pw(this.La(),"labelledby",a.id);a=this.Fa("waffle-create-datasheet-welcome-dialog-welcome-description");a.id=nw(this,"waffle-create-datasheet-welcome-dialog-welcome-description");Pw(this.La(),"describedby",a.id)};p.bUb=function(){rw("https://connectedsheets.page.link/support")};p.RSa=function(){this.resolve(!0)};p.ira=function(a){13==a.keyCode&&this.RSa()};p.M2=function(){MC.wb();this.reject()};p.$G=function(){MC.wb();this.reject()};function fFg(a){a=a.Fib;a='<div class="'+T("waffle-create-datasource-sheet-loading-dialog-section")+'"><img class="'+T("waffle-create-datasource-sheet-loading-dialog-image")+'" src="'+T(Ew(a))+'" alt=""><div class="'+T("waffle-create-datasource-sheet-loading-dialog-tip")+'">';return S(a+"Connecting data\u2026</div></div>")};function gFg(a,b){FZ.call(this,"waffle-create-datasource-sheet-loading-dialog",b);this.D=a}u(gFg,FZ);gFg.prototype.Ca=function(){FZ.prototype.Ca.call(this);Qx(this.Hb(),fFg,{Fib:this.D});Ow(this.Fa("waffle-dataconnector-modal-title"));var a=this.Fa("waffle-create-datasource-sheet-loading-dialog-tip");a.id=nw(this,"waffle-create-datasource-sheet-loading-dialog-tip");Nw(a,"heading");Pw(this.La(),"labelledby",a.id)};function hFg(){var a='<div class="'+T("waffle-create-datasource-sheet-success-dialog-section")+'"><img src="//ssl.gstatic.com/docs/spreadsheets/bigSheets_success_2.gif" class="'+T("waffle-create-datasource-sheet-success-dialog-image")+'" alt=""><h5 class="'+T("waffle-create-datasource-sheet-success-dialog-success-message")+'">';a=a+'Success! Your BigQuery data is connected and ready to analyze</h5><div class="'+(T("waffle-create-datasource-sheet-success-dialog-metadata-wrapper")+" "+T("waffle-create-datasource-sheet-success-dialog-datasource-info")+
'"></div><div class="'+T("waffle-create-datasource-sheet-success-dialog-success-description")+'">');a=a+"Create pivot tables, formulas, and charts in the same way you're already familiar with</div><div class=\""+(T("waffle-create-datasource-sheet-success-dialog-start-analyze-button-wrapper")+'"></div><div class="'+T("waffle-create-datasource-sheet-success-dialog-watch-tutorial")+" "+T("goog-link-button")+'"><span>');return S(a+"Watch video tutorial</span></div></div>")};function iFg(a,b,c){FZ.call(this,"waffle-create-datasource-sheet-success-dialog",c);this.J=a;this.H=b;this.F=new FB("Start analyzing",this.qa());this.Ga(this.F);this.D=new Gy(void 0,AO.getInstance(),this.qa());this.Ga(this.D)}u(iFg,FZ);
iFg.prototype.Ca=function(){var a=this;FZ.prototype.Ca.call(this);Qx(this.Hb(),hFg);var b=this.Fa("waffle-create-datasource-sheet-success-dialog-metadata-wrapper");this.qa().Ke(b,jFg(this.J,this.H));this.F.render(this.Fa("waffle-create-datasource-sheet-success-dialog-start-analyze-button-wrapper"));this.D.Va(this.Fa("waffle-create-datasource-sheet-success-dialog-watch-tutorial"));Ow(this.Fa("waffle-dataconnector-modal-title"));b=this.Fa("waffle-create-datasource-sheet-success-dialog-success-message");
b.id=nw(this,"waffle-create-datasource-sheet-success-dialog-success-message");Nw(b,"heading");Pw(this.La(),"labelledby",b.id);b=this.Fa("waffle-create-datasource-sheet-success-dialog-success-description");b.id=nw(this,"waffle-create-datasource-sheet-success-dialog-success-description");Pw(this.La(),"describedby",b.id);this.getHandler().listen(this.F,"action",function(){return a.$G()}).listen(this.D,"action",function(){return Jpb.wb()})};
function jFg(a,b){a=(new uA("{NUM_COLUMNS, plural,=0 {No columns}=1 {1 column}other {# columns}}")).format({NUM_COLUMNS:a});return b?b+" rows \u2022 "+a:a};function kFg(a,b,c,d,e,f,h,k,l,n,q,r){M9e.call(this,new e7e(n.getType(),l,"filter_db_sheet",r),a,b,c,d,e,f,h,k,l,q,r);this.Kb=iM(n);this.Dc=new Mk}u(kFg,M9e);p=kFg.prototype;p.Ca=function(){M9e.prototype.Ca.call(this);var a=nP(this.D,this.Rg());IDg(this.H.C,500<a.left?0:3)};
p.QNa=function(){var a=this.Sa().dc(),b=ritz_api.BigSheetsApi.getDatasourceSheetCriteria(a,this.Dc.serialize(this.Kb)),c=null,d=null;0<b.length&&(c=this.Dc.Tc(Xg.Aa(),b[0]),d=HXe(a));JXe(this.H,c,d);a=this.J;b=this.V;c=this.Sa().dc();c=ritz_api.BigSheetsApi.getDatasourceSheetSortOrder(c,this.Dc.serialize(this.Kb));ix(a.La(),"waffle-datasourcesheet-sort-selected",0==c);ix(b.La(),"waffle-datasourcesheet-sort-selected",1==c);a=this.C;b=a.Ob().La();ex(b,"waffle-datasourcesheet-filterbox-container");gW(a);
Zv(b,"");a.El()};p.tLa=function(a){if("filtering_cancelled"==a.type)this.Qa();else if(a=this.Rg(),a=CXe(this.H,this.Sa().dc(),a.y,a.x,!1,!1),!mXe(this.H.C)){if(null==a)var b=new gY("filterClear");else b=new gY("filterUpdate"),b.D=a;b.O=this.Kb;this.dispatchEvent(b);this.Qa()}};p.Bra=function(a){var b=new gY("filterSort");b.O=this.Kb;b.F=a?1:0;this.dispatchEvent(b)};p.PPa=m(!1);
p.pka=function(a){var b=this.D,c=oP(b,"r",a.y),d=b.C,e=2*d.C,f=this.Sa().Lg(a.y,a.x).getFormat();c=-c-e;a="rtl"==(f.D||null)||"auto-rtl"==(f.D||null)?e:oP(b,"c",a.x)-16*d.C-e;d=d.C;this.jz(new bm(a/d,c/d))};function lFg(a,b,c,d,e,f){d=void 0===d?null:d;e=void 0===e?!1:e;f=void 0===f?!1:f;SK.call(this,147);this.R=a.dc();this.O=b;this.C=c||[];this.F=d;this.J=e;this.L=f}u(lFg,SK);lFg.prototype.Id=function(){var a=new cLb;E(a,1,this.R);E(a,7,this.O);if(this.J)E(a,5,!0);else for(var b=0;b<this.C.length;b++)fg(a,3,this.C[b]);this.L?E(a,6,!0):null!=this.F&&E(a,4,this.F);return a};
lFg.prototype.equals=function(a){return this.R==a.R&&this.O.equals(a.O)&&this.J==a.J&&this.L==a.L&&this.F==a.F&&td(this.C,a.C,function(b,c){return b.equals(c)})};function mFg(a,b,c,d,e,f,h){A.call(this);this.xa=a;this.O=h;this.ma=b;this.D=c;this.V=d;this.R=e;this.L=f;this.Ma=new Xn(this);this.va(this.Ma);this.C=null;this.F=new Mk;this.H=new Fz(this);this.va(this.H);this.Ma.listen(this.D,"filter-triggered",this.J);this.H.subscribe(eD,"action",this.J)}u(mFg,A);
mFg.prototype.J=function(){var a=dR(this.ma);if(a&&nH(a)){var b=XK(this.D),c=nFg(this),d=sK(c),e=qK(nFg(this));d=new bm(d.x,e.y);e=JFd(c,d.x);this.C&&(this.C.dispose(),this.C=null);this.C=new kFg(c,this.R,b.R,b.C,b.F,new TN(d),!1,!1,this.V,e,this.O);this.va(this.C);CO(iLc(b),this.C);this.Ma.listen(this.C,"filterClear",this.Ba).listen(this.C,"filterSort",this.Ha).listen(this.C,"filterUpdate",this.Ea);this.C.pka(d);this.C.Pc();this.C.C.Fd(!0);b=iM(e);a=ritz_api.BigSheetsApi.getDatasourceSheetSortOrder(a.ib(),
this.F.serialize(b));b=io("waffle-autofilter-sort waffle-datasourcesheet-sort-selected");null!=a&&b&&(Sw(b,b.innerText+" selected"),ix(b,"hc-enabled-focus","black"==ez()))}};mFg.prototype.Ba=function(a){a=new lFg(nFg(this),a.O,null,null,!0);oFg(this,a)};mFg.prototype.Ea=function(a){var b=new Xg;E(b,4,a.D);a=new lFg(nFg(this),a.O,[b],null);oFg(this,a)};
mFg.prototype.Ha=function(a){var b=nFg(this).dc(),c=a.O;b=ritz_api.BigSheetsApi.getDatasourceSheetSortOrder(b,this.F.serialize(c));var d=!1;switch(a.F){case 1:d=0==b;break;case 0:d=1==b}a=d?new lFg(nFg(this),c,null,null,void 0,!0):new lFg(nFg(this),c,null,1==a.F?0:1);oFg(this,a)};function oFg(a,b){a.L.C(b);vHe(iLc(XK(a.D)));Hf(a.C);a.C=null}function nFg(a){return JJ(a.xa.C)};function pFg(a,b,c,d,e,f,h){A.call(this);var k=this;this.Ma=new Xn(this);this.va(this.Ma);this.xa=a;this.J=a.O;this.F=b;this.C=c;this.V=e;this.R=f;this.O=new Fz(this);this.va(this.O);this.ma=h;this.H=this.D=null;qFg(this);rFg(this,d);this.L=new zn;this.va(this.L);An(this.L,this.J.D,function(l){var n=sFg(k);n&&DGe(l,n)&&tFg(k,n)})}u(pFg,A);function qFg(a){var b=new Cv(["waffle-dbsheet-or-dbobject-pill-active"]);a.R.C(Apb,b)}
function rFg(a,b){var c=TH(a.xa.C);a.Ma.listen(b,"J",a.vFb).listen(c,"Db",a.dUb).listen(c,["mb","zb"],a.cea).listen(a.F,"ga",a.cea).listen(a.C,"activeCellChange valueChange blurEmbeddedObject embeddedObjectMouseEnter embeddedObjectMouseLeave focusEmbeddedObject".split(" "),a.cea).listen(a.C,"inputBoxActivate",a.yca).listen(a.C,"mouseover",a.cUb).listen(a.C,"refresh-db-object-request",a.hNa).listen(a.F,"ha",a.Qma).listen(a.C,"db-connection-settings",a.yLa);a.O.subscribe(Apb,"action",a.$sb)}p=pFg.prototype;
p.Ja=function(){this.Qma();A.prototype.Ja.call(this)};p.dUb=function(){var a=XK(this.C);a&&YK(this.C)&&DKc(a)};p.Qma=function(){If(uFg(this),vFg(this),this.D);this.H=this.D=null};p.vFb=function(){this.D&&DDg(this.D)};
p.cea=function(){var a=XK(this.C),b=dR(this.F);if(a&&b){b=!!a.Wa;var c=!!eLc(a);b||!c||a.Wa||(a.Wa=new EDg(a.Sa(),a.R,a.C,a.F,new TN($Kc(a),new bm(0,0)),a.Ea,a.Kb,a.gb),oQ(a.V,"default",a.Wa,!0),a.va(a.Wa),a.Wa.setVisible(!0));b=a.Sa();a=eLc(a)||sK(b);(a=dK(PJ(b,a),a,b.dc()))&&(a.C||a.D)?this.yca():(a=sFg(this),a!=this.H&&tFg(this,a))}else this.Qma()};function tFg(a,b){if(b){a.yca();var c=wFg(a);if(c){var d=NT(a.J,b),e=dxc(b);Exc(c,d,e);4==e.C&&DDg(c);xFg(a,b,c,d);a.H=b}}else a.yca()}
p.yca=function(){var a=uFg(this);a&&a.setVisible(!1);(a=vFg(this))&&a.setVisible(!1);this.H=null};p.$sb=function(){var a=wFg(this);a&&(a.La().focus(),this.V.Ub(2))};p.hNa=function(){var a=sFg(this);if(a)switch(ritz_api.BigSheetsApi.getDbObjectTypeForExternalDataSourceId(a)){case 1:Nob.wb(a);break;case 5:Qob.wb(a);break;case 3:Tob.wb(a);break;case 2:Oob.wb(a);break;case 4:Epb.wb(a)}};
p.yLa=function(){var a=sFg(this);if(a){var b=ritz_api.BigSheetsApi.getDataSourceIdForExternalDataId(a);b&&(a=ritz_api.BigSheetsApi.getSheetIdForDatasourceId(b))&&fR(this.F,a,function(){Gpb.wb(new NEg(b))})}};p.cUb=function(a){var b=dR(this.F),c=XK(this.C);c&&b&&3!=b.getSheetType()&&(a=a.Vj)&&zmc(a)&&(this.cea(),DKc(c))};
function wFg(a){var b=sFg(a);if(!b)return null;var c=ritz_api.BigSheetsApi.getDbObjectTypeForExternalDataSourceId(b);if(4==c)if(3!=dR(a.F).getSheetType())a=null;else{if(!a.D){c=XK(a.C);b=c.Le();a.D=new zxc(a.ma,b);a.Ma.listen(a.D,"refresh-db-object-request",a.hNa).listen(a.D,"db-connection-settings",a.yLa);c=new Mw(c.Ha.J,b?5:1);a.D.render();var d=a.D;d.cd=c;d.L=b}a=a.D}else if(2==c)if(a=XK(a.C))a:if(c=a.J.C,GDg(a)==b)b=FDg(a.J).Wd().getId(),a=oLc(a,b);else{for(d=c.length-1;0<=d;d--){var e=c[d];if(e&&
ritz_api.BigSheetsApi.getExternalDataIdForObject(e)==b){a=oLc(a,e);break a}}a=null}else a=null;else a=vFg(a);return a}function uFg(a){return(a=XK(a.C))?nLc(a):null}function vFg(a){a=XK(a.C);return a?(a=a.Wa)?a.F:null:null}function sFg(a){return(a=XK(a.C))?HDg(a):null}function xFg(a,b,c,d){UC.isEnabled()&&yFg(d.getType())&&fFd(a.J,b,function(e){return c.hw(e)},function(e){return c.QB(e)})}function yFg(a){return"no-results"==a||"fetch-successful"==a||"fetch-failed"==a};function zFg(a,b){SK.call(this,154);this.F=a;this.C=b}u(zFg,SK);zFg.prototype.Id=function(){var a=new pLb;E(a,1,this.F);for(var b=0;b<this.C.length;b++)fg(a,2,this.C[b]);return a};function AFg(a,b){this.D=a;this.C=b};function BFg(a){this.D=a;this.C={};this.F=new Mk}
function CFg(a,b){b&&b.forEach(function(c){if(a.C[c]){var d=(new Date).getTime()-a.C[c].D,e=idc(c),f=e?e.getState():null;if(e&&f&&(2==f||3==f)){if(e=DFg[f]){d=Aj(new zj,1E3*d);var h=a.C[c].C;f=new Spe;f=M(f,2,h);var k=ritz_api.RitzModelApi.getExternalData(c);if(k){k=a.F.Tc(Zh.Aa(),k);a:switch(h){case 3:var l=D(k,6).getFormat();l=eg(l,1)+eg(l,2)+eg(l,3);break a;case 6:l=D(k,8)?1:0;break a;default:l=eg(D(k,7),1)}M(f,5,l);a:switch(h){case 3:h=D(k,6);h=eg(h,3);break a;case 6:h=D(k,8)?1:0;break a;default:h=
eg(D(k,7),2)}M(f,4,h)}h=new Ej;f=cj(h,16,f);f=Gj(f,!0);d=By(zy(xy(new wy,41),d),f);a.D.C(e,Cy(d))}delete a.C[c]}}})}var EFg={},DFg=(EFg[2]=36294,EFg[3]=36567,EFg);function FFg(a,b){SK.call(this,139);this.C=a||"";this.F=b}u(FFg,SK);FFg.prototype.Id=function(){var a=new KKb;E(a,1,this.C);E(a,2,this.F);return a};FFg.prototype.yJ=function(){return MKb.Aa()};function GFg(a,b,c,d,e,f,h,k,l,n,q,r,w){V8e.call(this,a,b,d,f,h,k,l);var x=this;this.Pa=new aFg(b,this.F,l,q,f,c,n,d,w);this.va(this.Pa);this.fb=f;this.Ma=new Xn(this);this.va(this.Ma);this.Wa=new pFg(a,b,c,d,e,k,l);this.va(this.Wa);this.ma=n;this.Ka=a.D.C;this.Ha=new Mk;this.Oa=new BFg(l);this.$a=r;this.Ta=new mFg(a,b,c,l,e,n,w);this.va(this.Ta);this.L=new Set;this.O=new Set;(b=kC.getInstance().C.newDatasourceIdFromOnboarding)?(this.L.add(b),HFg(this)):kC.getInstance().C.showBigSheetsOnboardingDialogOnStart&&
Bpb.isEnabled()&&this.qZa();this.Ma.listen(this.F,"db-execution-status-updated",this.z6b).listen(this.D,"ga",this.C_a);this.Ea=new zn;this.va(this.Ea);An(this.Ea,a.O.D,function(B){x.C_a();IFg(x,B)})}u(GFg,V8e);p=GFg.prototype;
p.qDa=function(a){a.C(zpb,nT).F(zpb,nT).C(Dpb,nT).C(Gpb,Rvd).F(Gpb,Rvd).C(TC,nT).F(TC,nT).C(Epb,nT).C($ob,Rvd).C(Hpb,nT).C(Ipb,nT).C(UC,nT).C(Fpb,nT).C(SC,nT).C(wpb,nT).C(vpb,nT).C(Jpb,Rvd).F(Jpb,Rvd).C(xpb,Qvd).C(ypb,nT).F(ypb,nT);Ic(z(),"fedp")&&a.C(Nob,nT);Ic(z(),"fedr")&&a.C(Qob,nT);Ic(z(),"fedbc")&&a.C(Oob,nT);Ic(z(),"feci")&&a.C(Pob,nT);Ic(z(),"fedf")&&a.C(Tob,nT);Ic(z(),"fedors")&&a.C(apb,nT)};
p.g_a=function(){var a=this;this.V.subscribe(Dpb,"action",this.Ba).subscribe(zpb,"action",this.Tob).subscribe(TC,"action",this.TGb).subscribe(Gpb,"action",this.L9b).subscribe(Epb,"action",function(b){return JFg(a,1,b)}).subscribe(Oob,"action",function(b){return JFg(a,2,b)}).subscribe(Pob,"action",function(b){return JFg(a,6,b)}).subscribe(Qob,"action",function(b){return JFg(a,5,b)}).subscribe(Nob,"action",function(b){return JFg(a,3,b)}).subscribe(Tob,"action",function(b){return JFg(a,4,b)}).subscribe($ob,
"action",this.sEb).subscribe(Hpb,"action",this.Wya).subscribe(Ipb,"action",this.rZa).subscribe(apb,"action",function(b){0!==b.length&&(KFg(a,ritz_api.BigSheetsApi.createRefreshObjectRequest(b),null,b),LFg(a,b))}).subscribe(Jpb,"action",this.DHb).subscribe(SC,"action",function(){return MFg(a,null,!0)}).subscribe(wpb,"action",this.Heb).subscribe(vpb,"action",this.g$a).subscribe(xpb,"action",this.jcc).subscribe(ypb,"action",this.Vob)};p.z6b=function(a){CFg(this.Oa,a.D)};
p.TGb=function(a){NFg(this,a.Xf(),a.C)};
p.L9b=function(a){var b=this,c=a.Xf();a=ritz_api.BigSheetsApi.getDatasourceSlotDeltaProto(c);var d=this.Ha.Tc(Zg.Aa(),a),e=new KZ(eM.getInstance());xp(this.J,function(f){if(!TC.isEnabled()&&dg(d,3)&&dg(D(d,3),4)){var h=f.xgb(c,d);b.va(h);EZ(b.C,h)}else{var k=Y8e("Connecting to BigQuery\u2026");u8e(e).then(function(l){Zz(Yz.getInstance(),k);l=f.yHa(c,d,l);b.va(l);EZ(b.C,l)},function(){Zz(Yz.getInstance(),k);if(dg(d,3)&&dg(D(d,3),1)){var l=f.zHa(c,d,[],!0);b.va(l);EZ(b.C,l)}else b.Vba()})}})};
p.rZa=function(a){var b=this;xp(this.J,function(c){var d=a.H;if(d){var e=d.C;if(dg(D(e,3),4)){var f=D(d.C,3);e=D(f,5);var h=new Zg;E(h,2,2);var k=new $g;f=D(f,4);var l=f.Rh()||"";f=l+(l?".":"")+D(f,2)+"."+f.getName();E(k,1,"select * from `"+f+"`");E(k,5,e);E(h,3,k);e=h}c=c.yHa(d.Xf(),e,a.C)}else c=c.ogb(a);b.va(c);EZ(b.C,c)})};p.Tob=function(a){NFg(this,null,a.C)};
function NFg(a,b,c){var d=null==b;b=new FFg(b,c);TK(b,function(e,f){e&&(e=f.Xf(),OFg(a,e),d&&(a.L.add(e),HFg(a)))});a.ma.C(b);d||p7e(a.C)}function OFg(a,b){var c=ritz_api.BigSheetsApi.generateExternalDataIdForDatasourceSheet(b);b=ritz_api.BigSheetsApi.createRefreshObjectRequestForDatasourceSheetInitialLoad(c,b);KFg(a,b,1,[c])}
p.qZa=function(){var a=this,b=this.F.F.D["ritz-DisplayCountBigsheetsWelcomeDialog"],c=b.getValue();if(1<=c)this.Wya();else{b.setValue(Math.min(c+1,2147483647));var d=new eFg;this.va(d);EZ(this.C,d);d.getResult().then(function(e){e?a.Wya():Hf(d)},function(){Hf(d)})}};function HFg(a){var b=new gFg("//ssl.gstatic.com/docs/spreadsheets/bigsheets_loading_3.gif");a.va(b);EZ(a.C,b)}
function MFg(a,b,c){var d=dR(a.D);if(d&&nH(d)){var e=d.Xf();jM(a.F.xa,e).then(function(f){var h=new XDg(f,e);f=new tEg(e,b,f,h,a.F.Ta,c,a.ma,a.$a,a.Ka,a.R);a.va(f);a.Ma.listen(f,"update",a.Dmb);EZ(a.C,f)})}}p.Heb=function(){var a=dR(this.D);a&&nH(a)&&(a=PFg(a),MFg(this,a[0],!0))};p.jcc=function(){var a=dR(this.D);a&&nH(a)&&(a=PFg(a),MFg(this,a[0],!1))};
p.g$a=function(){var a=this,b=dR(this.D);if(b&&nH(b)){var c=PFg(b),d=c.length;d=(new uA("{NUM_COLUMNS, plural,=1 {Are you sure you want to delete this calculated column?}other {Are you sure you want to delete {NUM_COLUMNS} calculated columns?}}")).format({NUM_COLUMNS:d});BLc(this.fb,d,function(){return QFg(a,b.Xf(),c)})}};function QFg(a,b,c){c=new zFg(b,c);TK(c,function(d){a.R.C(d?36648:36649);!Ic(z(),"fedccp")&&d&&OFg(a,b)});a.ma.C(c)}
p.Dmb=function(a){Ic(z(),"fedccp")||OFg(this,a.Ms);var b=dR(this.D);b&&nH(b)&&b.Xf()==a.Ms&&a.C&&(a=b.Ic(),b=wm(new bm(a.gg()-1,0)),AJ(a,RXb(a,b)))};function PFg(a){a=a.Ic();var b=oK(a);return Rwc(a,b).map(function(c){return D(c,2)})}
p.C_a=function(){var a=dR(this.D);if(a&&nH(a)){var b=a.Xf();if(this.L.has(b)){var c=ritz_api.BigSheetsApi.getExternalDataIdForDatasourceSheet(a.ib());if(c)if(c=NT(this.F.O,c),"fetch-successful"==c.getType()){a=a.Ic().gg();var d=ritz_api.BigSheetsApi.getDatasourceTotalRowCount(b);c=null;null!==d&&(d=parseInt(d,10),0<d&&(c=yxc.format(d)));a=new iFg(a,c);this.va(a);EZ(this.C,a);this.L.delete(b)}else"fetch-failed"==c.getType()&&(o7e(this.C)instanceof gFg&&q7e(this.C),this.L.delete(b))}}};
p.Wya=function(){var a=this,b=new PDg(new KZ(eM.getInstance()),this.R);this.va(b);EZ(this.C,b);b.getResult().then(function(d){a.rZa(d)},function(d){d&&a.Vba();Hf(b)});var c=new WK(b.getElement());w4b(c,"loadingGif","//ssl.gstatic.com/docs/spreadsheets/bigsheets_loading_3.gif");c.start()};p.Vba=function(){this.R.C(36685);$8e("Could not connect to BigQuery")};function JFg(a,b,c){KFg(a,ritz_api.BigSheetsApi.createRefreshObjectRequest([c]),b,[c]);LFg(a,[c])}
function KFg(a,b,c,d){b=a.Ha.Tc(Jac.Aa(),b);var e=(new Date).getTime();CDg(a.F.O,d);BDg(eM.getInstance(),b,a.Ka).then(function(f){var h=jg(f,2),k=1==d.length?d[0]:null;!h[0].Bi().Kl()&&k&&c&&(a.Oa.C[k]=new AFg(e,c));h=ia(h);for(k=h.next();!k.done;k=h.next()){var l=k.value;k=l.Bi();3===k.getState()&&(l=l.Zz(),vdc(a.F.O,new Set([l]),k))}return f},function(f){var h=vdc,k=a.F.O,l=new Set(d);f=D(f,2,0);h(k,l,f.Bi())})}
function LFg(a,b){if(0!=b.length){var c=new uA("{numObjects, plural, =1 {Refreshing object} other {Refreshing # objects}}");RK(c.format({numObjects:b.length}));b.forEach(function(d){return a.O.add(d)})}}function IFg(a,b){0!=a.O.size&&(b.C.forEach(function(c){var d=NT(a.F.O,c);"loading"!=d.getType()&&"fetching-results"!=d.getType()&&a.O.delete(c)}),0==a.O.size&&"dbobjectmodel-event-update"==b.getType()&&RK("Refresh complete"))}
p.sEb=function(a){if(a){var b=ritz_api.BigSheetsApi.getDbObjectTypeForExternalDataSourceId(a.Zz());a=MDg(b,a.C);X1b(a.body,ba(),a.title,RFg,this.RTb,void 0,void 0,!1,"big-sheets-feedback")}};p.DHb=function(){rw("https://connectedsheets.page.link/tutorial",{target:"_blank"})};p.RTb=function(){rw("https://connectedsheets.page.link/support")};p.Vob=function(){var a=dR(this.D);a&&nH(a)&&(ddc(this.F.xa),l2b(a.Xf()))};var RFg={ok:"OK",cancel:"Learn more"};function SFg(){A.call(this)}u(SFg,IK);SFg.prototype.C=function(){return GFg};NK("dbsource",SFg);
