(function(){(function(){if(!window.GLIFFY){window.GLIFFY={}}GLIFFY.Message=function(b,c){var a=this;a.__postMessage=b||a.__postMessage;a.__isValidOrigin=c||a.__isValidOrigin;a.__actions={};window.addEventListener("message",function(d){var e=d.data.action;if(a.__isValidOrigin(d)&&e in a.__actions){a.__actions[e](d.data.data,function(f){a.__postMessage({requestAction:e,response:{status:200},data:f})},function(f,g){a.__postMessage({requestAction:e,response:{status:f,responseText:g},data:g})})}})};GLIFFY.Message.prototype.__isValidOrigin=function(a){return a.source===window.parent};GLIFFY.Message.prototype.__postMessage=function(a){window.parent.postMessage(a,"*")};GLIFFY.Message.prototype.send=function(e,d,f,c){var b,a=this;if(typeof(d)==="function"){throw new Error("Data cannot be a function. please pass in null if there is no data to send.")}if(f||c){b=function(g){if(a.__isValidOrigin(g)&&g.data.requestAction===e){window.removeEventListener("message",b,false);if(g.data.response.status===200){if(f){f(g.data.data)}}else{if(c){c(g.data.response,g.data.data)}}}};window.addEventListener("message",b,false)}this.__postMessage({action:e,data:d})};GLIFFY.Message.prototype.registerReceiveAction=function(a,b){this.__actions[a]=b};GLIFFY.Message.prototype.registerReceiveActions=function(a){var b;for(b in a){if(a.hasOwnProperty(b)){this.__actions[b]=a[b]}}}}())}());